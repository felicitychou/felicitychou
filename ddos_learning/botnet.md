Refer : 《破坏之王:DDoS攻击与防范深度剖析》



绝大部分的分布式拒绝服务攻击都是从僵尸网络产生的。

僵尸程序是组成僵尸网络的基础，它通常指可以自动执行预定义功能，可以被预定义的指令控制的一种计算机程序。僵尸程序不一定都是恶意的，但在僵尸网络中的僵尸程序都是恶意用途。僵尸网络一般指僵尸控制者出于恶意目的，传播大量僵尸程序，并采用一对多的方式控制的大型网络。僵尸网络是在网络蠕虫、木马、后门等传统恶意代码形态的基础上发展并融合而产生的一种复合攻击方式。



僵尸网络的特点：控制者和僵尸程序之间存在一对多的控制关系；控制者发布指令后，就可以断开与僵尸网络的连接。



常见恶意代码特性对比

| 类型   | 传播性  | 可控性  | 窃密性  | 危害级别   |
| ---- | ---- | ---- | ---- | ------ |
| 僵尸   | 有    | 高度可控 | 有    | 全部控制：高 |
| 蠕虫   | 主动传播 | 一般没有 | 一般没有 | 网络流量：高 |
| 木马   | 不具备  | 可控   | 有    | 帐号密码：高 |
| 后门   | 不具备  | 可控   | 有    | 完全控制：高 |
| 病毒   | 用户干预 | 一般没有 | 一般没有 | 感染文件：中 |
| 间谍   | 一般没有 | 一般没有 | 有    | 信息泄漏：中 |



简化的僵尸网络拓扑图

```
僵尸网络控制者 -攻击指令-> C&C服务器 
                         |
                         -控制信息-> 僵尸网络 -感染传播-> 其他终端
                                      |
                                      -执行攻击-> 目标服务器
```







域名产生算法 Domain Generation Algorithm DGA  产生随机域名与C&C通信

通信数据采用数字签名校验，阻止sinkhole技术。



僵尸网络的组建

僵尸网络由大量功能节点（肉鸡）共同组成。

普通PC：感染传播、安装执行、接入僵尸网络、命令执行

服务器（高性能、大带宽、长时间持续在线）

移动设备

物联网设备



控制通信协议

IRC协议、HTTP协议、P2P协议

| 控制模式      | 网络规模 | 组网难度 | 抗打击性 | 流行度   |
| --------- | ---- | ---- | ---- | ----- |
| IRC型僵尸网络  | 一般   | 较简单  | 偏弱   | 国内较少见 |
| HTTP型僵尸网络 | 中等   | 一般   | 一般   | 国内较普遍 |
| P2P型僵尸网络  | 规模庞大 | 较困难  | 强    | 多见于国外 |



IRC：

bot与C&C通信：NICK／USER 上线 PING/PONG 心跳包

master 与C&C通信 ： 通过口令进行认证

单点失效，容易被监控



HTTP；blackenery

P2P：具有静态IP的服务节点Servent bot 与IP地址动态分配、私有IP地址等不能被因特网访问的client bot

节点都存有一张有限的邻接Servent bot节点的链表 peer list。一旦僵尸主机重启或脱离僵尸网络，将周期性主动连接其链表中的服务节点，维护整个僵尸网络的节点。

建立半分布式P2P僵尸网络，经历程序植入、感染传播和网络维护三个阶段。

受控主机上的僵尸程序感染其他主机，每感染一台都会首先判断感染的主机是否能成为服务节点，同时构建该僵尸主机的链表。被植入僵尸程序之后，自启动僵尸主程序，根据链表中的服务节点IP，主动连接其他僵尸节点。

攻击者连接网络中的服务节点，通过认证后注入控制命令，指令在各节点自动传播。服务节点收到指令后，与自身存储的指令链表比较。如果指令存在，则不处理。不存在则将指令转发给其他节点，最后僵尸节点将指令执行结果通过层层节点再反馈给攻击者。



僵尸网络的危害

- 发动DDoS攻击
- 发送攻击邮件
- 窃密敏感信息
- 抢占系统资源

